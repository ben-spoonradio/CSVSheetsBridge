# Google Apps Script 배포 가이드

이 문서는 Google Apps Script 웹 앱을 설정하고 배포하는 단계별 가이드입니다.

## 📋 사전 준비

- Google 계정
- 웹 브라우저 (Chrome 권장)
- 수정 가능한 Google Sheets (테스트용)

## 🚀 단계별 배포 가이드

### 1단계: Google Apps Script 프로젝트 생성

1. **Google Apps Script 접속**
   - https://script.google.com 으로 이동
   - Google 계정으로 로그인

2. **새 프로젝트 생성**
   - "새 프로젝트" 버튼 클릭
   - 프로젝트 이름을 의미있는 이름으로 변경 (예: "SheetsAPI")

### 2단계: 코드 추가

1. **코드 복사**
   - `Code.gs` 파일의 모든 내용을 복사
   - Apps Script 편집기의 기본 `Code.gs` 파일에 붙여넣기 (기존 내용 삭제 후)

2. **코드 저장**
   - `Ctrl+S` (Windows) 또는 `Cmd+S` (Mac)으로 저장
   - 또는 메뉴에서 "파일" > "저장" 클릭

### 3단계: 권한 설정

1. **함수 테스트 (선택사항)**
   - 함수 목록에서 `testFunction` 선택
   - "실행" 버튼 클릭
   - 권한 요청 시 "권한 검토" 클릭
   - Google 계정 선택 후 "허용" 클릭

### 4단계: 웹 앱으로 배포

1. **배포 메뉴 접근**
   - 편집기 우상단의 "배포" 버튼 클릭
   - "새 배포" 선택

2. **배포 유형 설정**
   - 유형 선택 버튼 (⚙️) 클릭
   - "웹 앱" 선택

3. **배포 설정**
   ```
   설명: Sheets API Web App
   실행 계정: 나
   액세스 권한: 모든 사용자 (또는 Google 계정이 있는 모든 사용자)
   ```

4. **배포 실행**
   - "배포" 버튼 클릭
   - 권한 요청 시 "액세스 승인" 클릭
   - Google 계정 선택
   - "고급" > "프로젝트명(안전하지 않음)으로 이동" 클릭
   - "허용" 클릭

5. **웹 앱 URL 복사**
   - 배포 완료 후 나타나는 웹 앱 URL 복사
   - 형태: `https://script.google.com/macros/s/SCRIPT_ID/exec`
   - 이 URL을 Python 코드에서 사용

### 5단계: 테스트

1. **테스트 스프레드시트 준비**
   - Google Sheets에서 새 스프레드시트 생성
   - URL에서 스프레드시트 ID 확인
   - 형태: `https://docs.google.com/spreadsheets/d/SHEET_ID/edit`

2. **웹 앱 테스트**
   - 브라우저에서 다음 URL 접속:
   ```
   https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec?sheetId=YOUR_SHEET_ID
   ```
   - JSON 형태의 응답이 나오면 성공

## 🔧 문제 해결

### 일반적인 오류와 해결방법

#### "권한 부족" 오류
- **원인**: Google Sheets 접근 권한이 없음
- **해결**: 배포 시 권한 승인 단계를 다시 수행

#### "스크립트를 찾을 수 없음" 오류
- **원인**: 잘못된 스크립트 ID
- **해결**: Apps Script 편집기에서 올바른 웹 앱 URL 재확인

#### "시트를 찾을 수 없음" 오류
- **원인**: 잘못된 스프레드시트 ID 또는 접근 권한 없음
- **해결**:
  1. 스프레드시트 ID 재확인
  2. 스프레드시트 공유 설정 확인

### 디버깅 방법

#### 1. Apps Script 로그 확인
```javascript
function testFunction() {
  Logger.log('테스트 시작');
  // 테스트 코드
  Logger.log('테스트 완료');
}
```
- 실행 후 "실행" > "로그 보기"에서 로그 확인

#### 2. 브라우저 개발자 도구
- F12 키로 개발자 도구 열기
- Network 탭에서 요청/응답 확인
- Console 탭에서 JavaScript 오류 확인

## 🔄 업데이트 방법

### 코드 수정 후 재배포

1. **코드 수정**
   - Apps Script 편집기에서 코드 수정
   - 저장 (`Ctrl+S` 또는 `Cmd+S`)

2. **새 배포 생성**
   - "배포" > "새 배포" 클릭
   - 새 버전으로 배포

3. **기존 배포 관리**
   - "배포" > "배포 관리"에서 기존 배포 관리
   - 필요시 URL 변경 없이 업데이트 가능

## 📝 체크리스트

배포 전 확인사항:
- [ ] Google Apps Script 프로젝트 생성 완료
- [ ] Code.gs 파일에 코드 복사 완료
- [ ] 코드 저장 완료
- [ ] 웹 앱으로 배포 완료
- [ ] 웹 앱 URL 복사 완료
- [ ] 테스트 스프레드시트 준비 완료
- [ ] 브라우저에서 웹 앱 접근 테스트 완료

## 💡 추가 팁

### 보안 고려사항
- 민감한 데이터가 포함된 스프레드시트는 "Google 계정이 있는 모든 사용자"로 제한
- 프로덕션 환경에서는 특정 사용자만 접근하도록 설정

### 성능 최적화
- 대량 데이터 처리 시 배치 작업 권장
- Apps Script 6분 실행 제한 고려
- 필요시 여러 요청으로 분할

### 모니터링
- Apps Script 실행 로그 정기적 확인
- 할당량 사용량 모니터링 (Apps Script 대시보드)

## 📞 지원

문제가 발생하면:
1. 이 가이드의 문제 해결 섹션 확인
2. Google Apps Script 공식 문서 참조
3. GitHub Issues에 문의